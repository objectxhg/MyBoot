<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xhg.mapper.UserMapper" >
   	
   	<resultMap type="com.xhg.pojo.User" id="UserResultMap">
	   <!-- property对应实体类的属性名称，column为数据库结果集的列的名称 -->
	   <id property="id" column="id" />
	   <result property="username" column="username"/>
	   <result property="pwd" column="pwd"/>
	   <result property="mobile" column="mobile"/>
	   <result property="birthday" column="birthday"/>
	   <result property="address" column="address"/>
	   <collection property="roleList" ofType="com.xhg.pojo.Role" select="selectUserRole" column="{userId = id}"> 
	   		
	   </collection>
	   
	</resultMap>
	
	<select id="selectUserRole" resultType="com.xhg.pojo.Role">
		select role.id,role.roleName 
		
			from sys_role role 
				 join 
				 sys_user_role userRole on role.id = userRole.roleId 
				 
			where userRole.userId = #{userId}
			
	</select>
   	
   	<select id="selectUserByName" parameterType="String"  resultMap="UserResultMap">
   		select * from sys_user where username = #{username}
   	</select>
   	
   	<select id="findAll" resultMap="UserResultMap">
   		select * from sys_user
   	</select>
   	
   	<insert id="addUser" parameterType="com.xhg.pojo.User">
   			insert into sys_user (
   			username,pwd,mobile,birthday,address
   			)
   			 values
   			 (#{username},#{pwd},#{mobile},#{birthday}#{address})
   	</insert>
   	
</mapper>